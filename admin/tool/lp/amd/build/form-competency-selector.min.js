define(["jquery","core/ajax","core/str"],function(a,b,c){var d;return{processResults:function(b,c){var e=[],f=a(b).data("potentialparentsonly"),g=a(b).data("frameworkmaxdepth");return!a(b).attr("multiple")&&f&&e.push({value:0,label:d}),a.each(c,function(a,b){var c=String(b.path),d=c.split("/").length-2;g=parseInt(g),(!f||g>d)&&e.push({value:b.id,label:b.shortname})}),e},transport:function(e,f,g,h){var i,j=a(e).data("competencyframeworkid");return i=b.call([{methodname:"tool_lp_search_competencies",args:{searchtext:f,competencyframeworkid:j}}]),"undefined"==typeof d?c.get_string("competencyframeworkroot","tool_lp").then(function(a){d=a,i[0].done(g),i[0].fail(h)}).fail(h):(i[0].done(g),i[0].fail(g)),i}}});
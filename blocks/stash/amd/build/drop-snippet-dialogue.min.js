define(["jquery","core/templates","core/yui","block_stash/drop-snippet-maker","block_stash/drop-snippet-ui"],function(a,b,c){function d(b){var d=a.Deferred();this._ready=d.promise(),this._drop=b,c.use("moodle-core-notification",function(){this._init().then(function(){d.resolve()})}.bind(this))}return d.prototype._dialogue=null,d.prototype._drop=null,d.prototype._maker=null,d.prototype._ready=null,d.prototype._ui=null,d.prototype._init=function(){var d,e=a.Deferred();d=new M.core.dialogue({draggable:!0,modal:!0,width:"600px"}),this._dialogue=d;var f=d.hide;return d.hide=function(){f.apply(d,arguments),this.destroy()}.bind(d),d.getStdModNode(c.WidgetStdMod.HEADER).prepend(c.Node.create("<h1>"+this._drop.get("name")+"</h1>")),this._render().then(function(a,e){b.runTemplateJS(e),d.setStdModContent(c.WidgetStdMod.BODY,a,c.WidgetStdMod.REPLACE)}).then(function(){e.resolve()}),e},d.prototype.find=function(a){return this._container.find(a)},d.prototype._render=function(){var a={drop:this._drop.getData(),dropjson:JSON.stringify(this._drop.getData()),item:this._drop.getItem().getData(),itemjson:JSON.stringify(this._drop.getItem().getData())};return b.render("block_stash/drop_snippet_dialogue",a)},d.prototype.show=function(a){this._ready.then(function(){this._dialogue.show(a)}.bind(this))},d});